for(pheno in allPhenos){
print(pheno)
for(tMode in runningMode_options){
print(tMode)
##subset() does not work well with a==a, important to know...
filt_AllInfo<-subset(All_InfoPredictions, runMode==tMode & Phenotype==pheno)
iterInfo<-backBoneMat
#Get statistics
iterInfo$N_Patients<-nrow(filt_AllInfo)
iterInfo$PercentagePredictions<-round((sum(filt_AllInfo$PathogenicScore>=0.8)/nrow(filt_AllInfo))*100, digits = 0)
iterInfo$Phenotype<-pheno
iterInfo$Mode<-tMode
#Adding info
summaryInfo<-rbind(summaryInfo, iterInfo)
}
}
summaryInfo$Phenotype<-factor(summaryInfo$Phenotype,
levels=allPhenos,
ordered = TRUE)##For the ggplot
lapply(summaryInfo, class)
##Quiero el de multiple groups
# http://www.sthda.com/english/wiki/ggplot2-barplots-quick-start-guide-r-software-and-data-visualization
library(ggplot2)
# x11()##TO AVOID GGPLOT2 MASSIVE COLLAPSE, OR USE GGSAVE
##He hecho un recorte del grafico, luego al insertarlo en office, he quitado las labels y las he puesto manualmente con mucha mejor resoluciÃ³n, asi como la leyenda
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/Revision_NAR/Manuscrito_New_Version/figures_and_tables/Figures/Figure4/Fig4a.tiff", units="in",
width=10, height=5, res=300)
p<-ggplot(data=summaryInfo, aes(x=Phenotype, y=PercentagePredictions, fill=Mode)) +
geom_bar(stat="identity", position=position_dodge()) +coord_flip()
p + theme_classic()
dev.off()
rm(list=ls())##Cleaning variables
####################################################################
## Analyisng frequency of Long-Range vs Direct
# panel b)
####################################################################
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/StandardMode_ParsedResults_MultiplePatientAnalyses.RData")
InfoPredictions<-cohort_results_standard$candidateGenesInfo
##Withouth Filt
allPhenoAllSV<-prop.table(colSums(InfoPredictions[,c("N_LR_Mech","N_Direct_Mech")]))
##Filt for Inv and Transloc
filt_InfoPred<-subset(InfoPredictions, TypeSV=="Inversion" | TypeSV=="Translocation")
allPheno_InvTrans<-prop.table(colSums(filt_InfoPred[,c("N_LR_Mech","N_Direct_Mech")]))
##Filt for Deletions Duplications
filt_InfoPred<-subset(InfoPredictions, TypeSV=="Deletion" | TypeSV=="Duplication")
allPheno_DelDup<-prop.table(colSums(filt_InfoPred[,c("N_LR_Mech","N_Direct_Mech")]))
###########################
## Hacer Stacked Barplots
###########################
library(ggplot2)
#Differences between phenos probably arised due to differenceson the depth of enhancer maps annotation
#Stacked barplot for all
df_stacked<-data.frame("percentages"=c(allPhenoAllSV,allPheno_DelDup, allPheno_InvTrans),
"typeMech"=factor(rep.int(x=c("LongRange","Direct"),times = 3),
levels = c("LongRange","Direct"), ordered = TRUE),
"groupObserv"=factor(c(rep.int(x="allPhenoAllSV", times=2),
rep.int(x="allPhenoDelDup", times=2),
rep.int(x="allPhenoInvTrans", times=2)),
levels = c("allPhenoAllSV","allPhenoDelDup","allPhenoInvTrans"), ordered = TRUE)
)
###Generating StackedBarplot
library(ggplot2)
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/Revision_NAR/Manuscrito_New_Version/figures_and_tables/Figures/Figure4/Fig4c.tiff", units="in",
width=5, height=5, res=300)
ggplot(df_stacked, aes(x=groupObserv, y=percentages, fill=typeMech))+
geom_bar(stat = "identity", width = .7)  +
ggtitle("Distribution Pathological mechanisms") +
theme(axis.text=element_text(size=12)) +
scale_fill_manual(values = c("#e699ff","#fce94f")) + theme_classic()
dev.off()
# 660066
#fce94f
###e699ff
rm(list = ls())
####################################################################################
## New panel, comparing % pathogenic predictions
####################################################################################
##Pathogenic SVs 270 patients
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/StandardMode_ParsedResults_MultiplePatientAnalyses.RData")
InfoPredictions_Standard<-cohort_results_standard$candidateGenesInfo
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/HighSpecificityMode_ParsedResults_MultiplePatientAnalyses.RData")
InfoPredictions_HighSpecificity<-cohort_results_hiSpe$candidateGenesInfo
#For Standard Mode
sum(InfoPredictions_Standard$PathogenicScore>=0.8)/nrow(InfoPredictions_Standard)
#For High Specificity Mode
sum(InfoPredictions_HighSpecificity$PathogenicScore>=0.8)/nrow(InfoPredictions_HighSpecificity)
#####################################
##Loading healthy svs predictions
#####################################
##Standard Mode
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/Robjects/candidateGenesInfo_10000_HealthyOriginal_SVs.RData")
postre_10000SVs<-originalHealthy_candidateGenesInfo
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/Robjects/candidateGenesInfo_2980_HealthyOriginal_SVs.RData")
postre_2980SVs<-originalHealthy_candidateGenesInfo
postre_healthy_standard<-unique(rbind(postre_10000SVs, postre_2980SVs))##unique to avoid duplicated info counted twice
rm(postre_10000SVs, postre_2980SVs)
sum(postre_healthy_standard$PathogenicScore>=0.8)/nrow(postre_healthy_standard)*100#4.3%
##High specificity mode
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/Robjects/candidateGenesInfo_10000_HighSpecificity_HealthyOriginal_SVs.RData")
postre_10000SVs<-originalHealthy_candidateGenesInfo
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/Robjects/candidateGenesInfo_2980_HighSpecificity_HealthyOriginal_SVs.RData")
postre_2980SVs<-originalHealthy_candidateGenesInfo
postre_healthy_standard<-unique(rbind(postre_10000SVs, postre_2980SVs))##unique to avoid duplicated info counted twice
rm(postre_10000SVs, postre_2980SVs)
sum(postre_healthy_standard$PathogenicScore>=0.8)/nrow(postre_healthy_standard)*100#1%
# For standard mode
# 59% and 4%
# For high specificity mode
# 23% and 1%
dataPlot<-data.frame("percentages"=c(59,4,
23,1),
"Mode"=factor(x=c("St","St","Hs","Hs"), levels = c("St","Hs"), ordered = TRUE),
"groupSV"=factor(x=c("Patho","Healthy", "Patho","Healthy"),
levels = c("Patho","Healthy"), ordered = TRUE))
library(ggplot2)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=5, height=5, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=10, height=10, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=10, height=6, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=10, height=8, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=10, height=8, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=10, height=8, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.2,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=4, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.2,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=4, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.2,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=4, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.8,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=4, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.5,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=4, res=300)
ggplot(data = dataPlot, aes(x = Mode, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
View(dataPlot)
subset(dataPlot,Mode=="St")
gg<-dataPlot
gg<-dataPlot
subset(gg,Mode=="St")
gg
gg<-subset(gg,Mode=="St")
gg
gg<-subset(gg,Mode=="St")
gg$Mode<-NULL
gg[2,1]<-3.2
gg
gg<-dataPlot
gg<-subset(gg,Mode=="St")
gg$Mode<-NULL
gg[2,1]<-3.2
ggplot(data = gg, aes(x = group, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
gg
ggplot(data = gg, aes(x = groupSV, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
# theme_set(theme_classic())
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=4, res=300)
gg<-dataPlot
gg<-subset(gg,Mode=="St")
gg$Mode<-NULL
gg[2,1]<-3.2
ggplot(data = gg, aes(x = groupSV, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
##For presentations plot
gg<-dataPlot
gg<-subset(gg,Mode=="St")
gg$Mode<-NULL
gg
##For presentations plot
gg<-dataPlot
gg<-subset(gg,Mode=="St")
gg$Mode<-NULL
gg[2,1]<-3.2
gg
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=4, res=300)
ggplot(data = gg, aes(x = groupSV, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.4,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=4, res=300)
ggplot(data = gg, aes(x = groupSV, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.8,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=2, res=300)
ggplot(data = gg, aes(x = groupSV, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.8,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=2, res=300)
ggplot(data = gg, aes(x = groupSV, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.8,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
gg
gg$groupSV
gg$groupSV<-factor(as.character(gg$groupSV), levels = c("Healthy","Patho"), ordered = TRUE)
gg
gg$groupSV
##For presentations plot
gg<-dataPlot
gg<-subset(gg,Mode=="St")
gg$Mode<-NULL
gg[2,1]<-3.2
gg$groupSV<-factor(as.character(gg$groupSV), levels = c("Healthy","Patho"), ordered = TRUE)
gg
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=2, res=300)
ggplot(data = gg, aes(x = groupSV, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.8,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#00ccff","#cc66ff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/FiguresPresentationTool/FigPercentagesPathoVsHealthy.tiff", units="in",
width=8, height=2, res=300)
ggplot(data = gg, aes(x = groupSV, y = percentages, fill = groupSV )) +
geom_bar(stat = "identity",  width = 0.8,
position=position_dodge(width = 0.5))+
scale_fill_manual(values = c("#cc66ff","#00ccff"))+theme(legend.position = "none") + theme_classic() + coord_flip()
dev.off()
##Loading Table, Manually Generated
##Info obtained from script: ~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/SV_LocalAnalysis/MultiplePatientAnalysis/evaluating_Sensitivity_OnPatientsData/3_ParsingPatientsPredictions.R
infoPredictions<-read.delim(file = "~/Dropbox/Cantabria/PhD_Project/DatosPHD/software_SV/dataManuscript/PredictionsPercentages.tab",
sep="\t",
header = TRUE,
stringsAsFactors = TRUE) ##This true, buecause for GGPLOT better
infoPredictions<-subset(infoPredictions, Mode=="Standard")
infoPredictions$Mode<-"Pathogenic"
################################################
##Meter datos de %s predichos para controles
###############################################
info_Healthy<-infoPredictions
info_Healthy$N_Patients<-10000
info_Healthy$Mode<-"Healthy"
info_Healthy$PercentagePredictions<-c(5.32,3.41,1.47,2.76)#c(2.7,2.6,1.5,2.2)
infoPredictions<-rbind(infoPredictions, info_Healthy)
lapply(infoPredictions, class)
p<-ggplot(data=infoPredictions, aes(x=Phenotype, y=PercentagePredictions, fill=Mode)) +
geom_bar(stat="identity", position=position_dodge()) +coord_flip() #+ theme_classic()
p
#########################################
## Parsing Predictions Patients
#########################################
##CHECK PATIENTS WITH ERRORS RISED IF ANY
##TAKE AS REFERENCE SCRIPT: ~/Documentos/phD/SV_app_backup/SV_LocalAnalysis_backup_21Dic_2021/MultiplePatientAnalysis/evaluatingSpecificity_OnHealthyIndividuals/Considering_Most_Of_SVs/3_ParsingResults.R
############
## Loading prediction results
load("~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/results_MultiplePatientAnalyses.RData")
## Loading SVs information
load("~/Dropbox/Cantabria/PhD_Project/DatosPHD/fichasPacientes/AllPatientsInfo.RData")
########################
# NOT TOUCHING FROM HERE. Use the remaining script above for all kind of prediction, either controls or pathogenic
# When doing them locally
########################
##Phenotypes to be considered
consideredPheno<-c("head_neck",
"cardiovascular",
"limbs",
"neurodevelopmental")##As more phenos considered they will appear here
###Setwd in the folder where all the app info is hosted
setwd("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/")
##############################################
##Loading Required Function
source("functions/multiple_SV_Functions/cohortResults_Parser.R")
#############
#Parsing predictions
cohort_results_hiSpe<-cohortResults_Parser(minScore = 0.8, all_patientResults = resultsPerMode$`High-Specificity`,
consideredPheno =consideredPheno,##Improve as more Phenos can be processed##consideredPheno,##Multiple Option, for now stick with head_neck
discardRelevantByBrokenGene = FALSE,
AllPatientsInfo = AllPatientsInfo )
cohort_results_standard<-cohortResults_Parser(minScore = 0.8, all_patientResults = resultsPerMode$Standard,
consideredPheno =consideredPheno,##Improve as more Phenos can be processed##consideredPheno,##Multiple Option, for now stick with head_neck
discardRelevantByBrokenGene = FALSE,
AllPatientsInfo = AllPatientsInfo )
###################################################
## Saving parsed results, Used to generate HTML
###################################################
save(cohort_results_standard,
file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/StandardMode_ParsedResults_MultiplePatientAnalyses.RData")
save(cohort_results_hiSpe,
file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/HighSpecificityMode_ParsedResults_MultiplePatientAnalyses.RData")
##Save info candidate genes for attempt of matching
originalPathogenic_candidateGenesInfo<-cohort_results_standard$candidateGenesInfo
save(originalPathogenic_candidateGenesInfo,
file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/Robjects/candidateGenesInfo_Pathogenic_SVs.RData")
###################################
## Exploring cohort Parsed results
###################################
targetPhenos<-c("head_neck",
"cardiovascular",
"limbs",
"neurodevelopmental")##As more phenos considered they will appear here
##Required functions
source("/home/victor/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/SV_LocalAnalysis/MultiplePatientAnalysis/functions/multiSV_analysis_stats_functions.R",
local = TRUE)
##Para High specificity
multiSV_analysis_stats(targetPhenos = targetPhenos, targetResults = cohort_results_hiSpe)
#Para Standard
multiSV_analysis_stats(targetPhenos = targetPhenos, targetResults = cohort_results_standard)
#########################################
## Parsing Predictions Approach 2
#########################################
##CHECK PATIENTS WITH ERRORS RISED IF ANY
##TAKE AS REFERENCE SCRIPT: ~/Documentos/phD/SV_app_backup/SV_LocalAnalysis_backup_21Dic_2021/MultiplePatientAnalysis/evaluatingSpecificity_OnHealthyIndividuals/Considering_Most_Of_SVs/3_ParsingResults.R
############
## Loading prediction results approach 2
load("~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/Robjects/results_PredictionsHealthyControls_approach1.RData")
## Loading SVs information
load(file = "~/Dropbox/Cantabria/PhD_Project/DatosPHD/fichasPacientes/healthyControls_approach1.RData")
########
#Renaming input data
AllPatientsInfo<-healthyControls_readyForSoftware
rm(healthyControls_readyForSoftware)
################################################################
## Applying filtering for DelDup or INv to stratify results
################################################################
##Required functions
source("/home/victor/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/SV_LocalAnalysis/MultiplePatientAnalysis/functions/multiSV_analysis_stats_functions.R",
local = TRUE)
## It can be "DELDUP" "INV" or "NONE" (doing nothing)
filteringCriteria<-"NONE" ##Also to analyze with TADA
# filteredInfo<-filtering_PatientsInfo(filteringCriteria = filteringCriteria,
#                                      AllPatientsInfo = AllPatientsInfo,
#                                      resultsPerMode = resultsPerMode)
#
# AllPatientsInfo<-filteredInfo$AllPatientsInfo
# resultsPerMode<-filteredInfo$resultsPerMode
length(resultsPerMode$Standard)==nrow(AllPatientsInfo)
length(resultsPerMode$`High-Specificity`)==nrow(AllPatientsInfo)
########################
# NOT TOUCHING FROM HERE. Use the remaining script above for all kind of prediction, either controls or pathogenic
# When doing them locally
########################
##Phenotypes to be considered
consideredPheno<-c("head_neck",
"cardiovascular",
"limbs",
"neurodevelopmental")##As more phenos considered they will appear here
###Setwd in the folder where all the app info is hosted
setwd("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/")
##############################################
##Loading Required Function
source("functions/multiple_SV_Functions/cohortResults_Parser.R")
#############
#Parsing predictions
# cohort_results_hiSpe<-cohortResults_Parser(minScore = 0.8, all_patientResults = resultsPerMode$`High-Specificity`,
#                                            consideredPheno =consideredPheno,##Improve as more Phenos can be processed##consideredPheno,##Multiple Option, for now stick with head_neck
#                                            discardRelevantByBrokenGene = FALSE,
#                                            AllPatientsInfo = AllPatientsInfo )
cohort_results_standard<-cohortResults_Parser(minScore = 0.8, all_patientResults = resultsPerMode$Standard,
consideredPheno =consideredPheno,##Improve as more Phenos can be processed##consideredPheno,##Multiple Option, for now stick with head_neck
discardRelevantByBrokenGene = FALSE,
AllPatientsInfo = AllPatientsInfo )
shiny::runApp()
?tags
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
masterWrapperSinglePrediction(patientInfo = patientData , minScore = minScore,
highScore = highScore, runMode = runMode_single,
user_tadMapInfo = user_tadMapInfo,
MultiDataList = MultiDataList)
runApp()
tagEnhancersLabel
yPos_chr_WT<-13 ##variable to hold the position of the chr text  in the WT situation in the Y axis
##Adjust image, to exclude spaces outside canvas (drawing area)
par(mar = c(0,0,0,0))
##OPTION REMOVING AXIS
#UPON COMPLETION USING THIS
plot(x=0:20, y=0:20, type = "n",
ylim = yAxisLim,
xlim = xAxisLim,
xaxt = 'n', yaxt = 'n', bty = 'n', pch = '', ylab = '', xlab = '') ##Upon completion, REMOVE AXIS
texSizeChr<-2
#Adding plot header
text(x=20, y=30, label=paste0("Graphical summary of ", gene, " regulatory domain in ", phase), cex = 1.7)
text(x=20,y=26, label="Simplification",cex=1.7)
#WT allelle label
text(x=20, y=20, label="Control Scenario", cex = 1.5)
##Coord for tads over X axis (Depending on the situation either two TADs or just one will be painted)
#Let's try make them wider two cm per side to ensure everything fits on the re-arrangement plots
tad_XCoord_OnLeftSide<-c(3,17,10)#c(5,15,10) ##c(3,17,10)
tad_XCoord_OnRightSide<-c(tad_XCoord_OnLeftSide[1]+10+11,
tad_XCoord_OnLeftSide[2]+10+11,
tad_XCoord_OnLeftSide[3]+10+11)
tad_XCoord_OnCenter<-c(13,27,20)
#Over Y axis, WT line
tad_YCoord_WildTypeLine<-c(0,0,15)
situation
text(x=5, y=yPos_chr_WT, label=chr_gene, cex = texSizeChr)
tad_X_cord<-tad_XCoord_OnLeftSide ##c(5,15,10)
info_drawingGENE_TAD<-paintGene_WT_TAD(tad_X_cord = tad_X_cord,
tad_Y_cord = tad_YCoord_WildTypeLine,
nEnh_initial_left = nEnh_initial_left,
nEnh_initial_right = nEnh_initial_right,
gene = gene,
gene_breakp_line_type = gene_breakp_line_type,
situation = situation,
patientResults = patientResults)
runApp()
runApp()
################################################################
##Test en mi usuario antiguo, para que sea la zona de pruebas
################################################################
rsconnect::deployApp('/home/victor/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/',
account = 'vicsanga')
runApp()
################################################################
##Test en mi usuario antiguo, para que sea la zona de pruebas
################################################################
rsconnect::deployApp('/home/victor/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/',
account = 'vicsanga')
runApp()
