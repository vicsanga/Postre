####################################################################################################
##Running shared code between All SVs and CNVs script
source("/home/victor/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/POSTRE_AdditionalAnalysis_For_Revision/Benchmarking/2_comparingPathogenicScores/4_SharedCode.R")
###########################################
## POSTRE pathogenic scores
###########################################
#####################
##270SVs processing
# postre_270SVs<-postre_270SVs[postre_270SVs$TypeSV %in% c("Deletion","Duplication"),]
original_postre270SVs<-postre_270SVs
table(unique(original_postre270SVs[,c("SVid","TypeSV")])$TypeSV)##> 97+29: 126 inv transloc, so... 126 0s
postre_270SVs<-getingMaxScore(targetMatrix = postre_270SVs)
#################################
##Positive controls processing
# postre_PosCon<-postre_PosCon[postre_PosCon$TypeSV %in% c("Deletion","Duplication"),]
original_postre_PosCon<-postre_PosCon
table(unique(original_postre_PosCon[,c("SVid","TypeSV")])$TypeSV)##> 4+21: 25 inv transloc, so... 24 0s
postre_PosCon<-getingMaxScore(targetMatrix = postre_PosCon)
########################
##Healthy processing
# postre_healthy<-postre_healthy[postre_healthy$TypeSV %in% c("Deletion","Duplication"),]
original_postre_healthy<-postre_healthy
table(unique(original_postre_healthy[,c("SVid","TypeSV")])$TypeSV)##> 113 Inv, so... 113 0s
postre_healthy<-getingMaxScore(targetMatrix = postre_healthy)
View(postre_healthy)
shiny::runApp('Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app')
shiny::runApp('Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app')
shiny::runApp('Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app')
##############################################################################
##Master Regulators, those above the inflection point of the H3K27me3 curve
##############################################################################
###### filtering OverlapResults
## si los transcritos comparten TSS nos quedaremos con los 2 como un único
## pero si no lo comparten los trataremos por separado
load(file = "/home/victor/Dropbox/Cantabria/PhD_Project/Resultados/genesDesarrollo/findingDevelopGenes.RData")
#vamos a trabajar con cada TSS por separado
#de forma que si los dos tienen un pico de H3K27me3, trabajaremos con los 2
# y si solo hay uno, nos quedaremos con ese solo
#no obstante si que nos quedaremos con una única fila, si los dos transcritos presentan el mismo TSS y estan mapeados con el mismo pico
dim(developmentMatrix)
developmentMatrix<-unique(developmentMatrix) # de 34513 a 34513 (expected)
dim(developmentMatrix)
developmentMatrix<-as.data.frame(developmentMatrix)
#### anyadir columna lengths
#las pos picos estan como factores, las pasamos a numerico
developmentMatrix$peakStart<-as.numeric(as.character(developmentMatrix$peakStart))
developmentMatrix$peakEnd<-as.numeric(as.character(developmentMatrix$peakEnd))
developmentMatrix$longitudPicos<-developmentMatrix$peakEnd - developmentMatrix$peakStart
min(developmentMatrix$longitudPicos) #0 as expected
developForPlot<-developmentMatrix
rm(developmentMatrix)
developForPlot<-developForPlot[order(developForPlot$longitudPicos,decreasing = F),]
###################################
## Computing line inflexion point
###################################
library(inflection)
#########################
##con el metodo ESE
##Ahora si quitamos todos los que tienen 0 bases de H3K27me3
##Reordenamos de mayor a menor para tenerlo como un scree plot
genesWithSignal<-developForPlot[order(developForPlot$longitudPicos, decreasing = TRUE),]
#To compute inflection point excluding the 0 values
genesWithSignal<-subset(genesWithSignal, longitudPicos>0)$longitudPicos
##Tal y como indican en el paper para el scree plot, que es el mismo concepto
elbowPoint<-findiplist(x = 1:length(genesWithSignal), y = genesWithSignal,
index = 0##
)
##Check if method EDE is applicable
if(is.na(elbowPoint[2,3])){
print("method EDE not applicable")
}
##Loading again data of genes without exluding those without signal (peak length 0)
genesWithSignal<-developForPlot[order(developForPlot$longitudPicos, decreasing = TRUE),]
genesWithSignal<-genesWithSignal$longitudPicos
nroObservacion_limiteSuperior_RegionKneePoint<-elbowPoint[1,1] ##Pq va en decreasing
nroObservacion_limiteInferior_RegionKneePoint<-elbowPoint[1,2] ##Pq va en decreasing
kneePoint_ejeX<-elbowPoint[1,3]
elbowPoint<-elbowPoint[1,1]##ESE
genesWithSignal[elbowPoint]
targetLongitudPico<-genesWithSignal[elbowPoint]
plot(x=1:length(genesWithSignal), y=genesWithSignal, type = "l", lwd=3, main = "H3K27me3 peak size associated to TSS \n in ESCs", xlab = "TSS", ylab="H3K27me3 peak size")
abline(h=c(targetLongitudPico),col="red", lwd=2, lty=2)
abline(v=nroObservacion_limiteSuperior_RegionKneePoint,col="red", lwd=2, lty=2)
abline(v=kneePoint_ejeX, col="blue", lwd=2, lty=2)
abline(v=nroObservacion_limiteInferior_RegionKneePoint, col="green", lwd=2, lty=2)
text(x= 20000, y=12000, paste0(targetLongitudPico, " bp"), col="red")
thresh<-targetLongitudPico
#####################################################################
##### seleccion genes (TSS) de desarrollo, aquellos cuyo overalapped H3K27me3 peak > thresh
#####################################################################
genesDesarrollo_allInfo<-developForPlot[developForPlot$longitudPicos>=thresh,]
selectedDevelopGenes<-sort(unique(as.character(genesDesarrollo_allInfo$gene)))
########################################################################
##### no nos interesan ni los LINC ni los LOC asi que vamos a quitarlos
########################################################################
AllGenes<-as.character(unique(developForPlot$gene))#27090
LINCs<-AllGenes[grep("^LINC.*", AllGenes)]
LOCs<-AllGenes[grep("^LOC[0-9].*", AllGenes)]
NotRelevant<-c(LINCs,LOCs)#LINCs and LOCs
##########################################################################
###### seleccion de los TSS de interes
##########################################################################
selectedDevelopGenes<-selectedDevelopGenes[!(selectedDevelopGenes %in% NotRelevant)]
print(thresh)
print(length(selectedDevelopGenes))
####################
## Saving results
####################
hESC_polyCombGenes<-selectedDevelopGenes
save(hESC_polyCombGenes, file = "~/Dropbox/Cantabria/PhD_Project/Resultados/genesDesarrollo/Robjects/hESC_polyCombGenes.RData")
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/Revision_NAR/Manuscrito_New_Version/SupplementaryMaterial/SupplementaryFigures/Supplementary_Figure_1/ESC.tiff", units="in",
width=5, height=5, res=300)
plot(x=1:length(genesWithSignal), y=genesWithSignal, type = "l", lwd=3, main = "H3K27me3 peak size associated to TSS \n in ESCs", xlab = "TSS", ylab="H3K27me3 peak size")
abline(h=c(targetLongitudPico),col="red", lwd=2, lty=2)
abline(v=nroObservacion_limiteSuperior_RegionKneePoint,col="red", lwd=2, lty=2)
abline(v=kneePoint_ejeX, col="blue", lwd=2, lty=2)
abline(v=nroObservacion_limiteInferior_RegionKneePoint, col="green", lwd=2, lty=2)
text(x= 20000, y=12000, paste0(targetLongitudPico, " bp"), col="red")
dev.off()
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/Revision_NAR/Manuscrito_New_Version/SupplementaryMaterial/SupplementaryFigures/Supplementary_Figure_1/ESC.tiff", units="in",
width=8, height=4, res=300)
plot(x=1:length(genesWithSignal), y=genesWithSignal, type = "l", lwd=3, main = "H3K27me3 peak size associated to TSS \n in ESCs", xlab = "TSS", ylab="H3K27me3 peak size")
abline(h=c(targetLongitudPico),col="red", lwd=2, lty=2)
abline(v=nroObservacion_limiteSuperior_RegionKneePoint,col="red", lwd=2, lty=2)
abline(v=kneePoint_ejeX, col="blue", lwd=2, lty=2)
abline(v=nroObservacion_limiteInferior_RegionKneePoint, col="green", lwd=2, lty=2)
text(x= 20000, y=12000, paste0(targetLongitudPico, " bp"), col="red")
dev.off()
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/Revision_NAR/Manuscrito_New_Version/SupplementaryMaterial/SupplementaryFigures/Supplementary_Figure_1/ESC.tiff", units="in",
width=7, height=4, res=300)
plot(x=1:length(genesWithSignal), y=genesWithSignal, type = "l", lwd=3, main = "H3K27me3 peak size associated to TSS \n in ESCs", xlab = "TSS", ylab="H3K27me3 peak size")
abline(h=c(targetLongitudPico),col="red", lwd=2, lty=2)
abline(v=nroObservacion_limiteSuperior_RegionKneePoint,col="red", lwd=2, lty=2)
abline(v=kneePoint_ejeX, col="blue", lwd=2, lty=2)
abline(v=nroObservacion_limiteInferior_RegionKneePoint, col="green", lwd=2, lty=2)
text(x= 20000, y=12000, paste0(targetLongitudPico, " bp"), col="red")
dev.off()
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/Revision_NAR/Manuscrito_New_Version/SupplementaryMaterial/SupplementaryFigures/Supplementary_Figure_1/ESC.tiff", units="in",
width=6, height=3.8, res=300)
plot(x=1:length(genesWithSignal), y=genesWithSignal, type = "l", lwd=3, main = "H3K27me3 peak size associated to TSS \n in ESCs", xlab = "TSS", ylab="H3K27me3 peak size")
abline(h=c(targetLongitudPico),col="red", lwd=2, lty=2)
abline(v=nroObservacion_limiteSuperior_RegionKneePoint,col="red", lwd=2, lty=2)
abline(v=kneePoint_ejeX, col="blue", lwd=2, lty=2)
abline(v=nroObservacion_limiteInferior_RegionKneePoint, col="green", lwd=2, lty=2)
text(x= 20000, y=12000, paste0(targetLongitudPico, " bp"), col="red")
dev.off()
##############################################################################
##Master Regulators, those above the inflection point of the H3K27me3 curve
##############################################################################
###### filtering OverlapResults
## si los transcritos comparten TSS nos quedaremos con los 2 como un único
## pero si no lo comparten los trataremos por separado
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/genesDesarrollo/bofsMetilacion/pi2_findingDevelopGenes.RData")
#vamos a trabajar con cada TSS por separado
#de forma que si los dos tienen un pico de H3K27me3, trabajaremos con los 2
# y si solo hay uno, nos quedaremos con ese solo
#no obstante si que nos quedaremos con una única fila, si los dos transcritos presentan el mismo TSS y estan mapeados con el mismo pico
dim(developmentMatrix)
developmentMatrix<-unique(developmentMatrix) # de 34513 a 34513 (expected)
dim(developmentMatrix)
developmentMatrix<-as.data.frame(developmentMatrix)
#### anyadir columna lengths
#las pos picos estan como factores, las pasamos a numerico
developmentMatrix$peakStart<-as.numeric(as.character(developmentMatrix$peakStart))
developmentMatrix$peakEnd<-as.numeric(as.character(developmentMatrix$peakEnd))
developmentMatrix$longitudPicos<-developmentMatrix$peakEnd - developmentMatrix$peakStart
min(developmentMatrix$longitudPicos) #0 as expected
developForPlot<-developmentMatrix
rm(developmentMatrix)
developForPlot<-developForPlot[order(developForPlot$longitudPicos,decreasing = F),]
###################################
## Computing line inflexion point
###################################
library(inflection)
#########################
##con el metodo ESE
##Ahora si quitamos todos los que tienen 0 bases de H3K27me3
##Reordenamos de mayor a menor para tenerlo como un scree plot
genesWithSignal<-developForPlot[order(developForPlot$longitudPicos, decreasing = TRUE),]
#To compute inflection point excluding the 0 values
genesWithSignal<-subset(genesWithSignal, longitudPicos>0)$longitudPicos
##Tal y como indican en el paper para el scree plot, que es el mismo concepto
elbowPoint<-findiplist(x = 1:length(genesWithSignal), y = genesWithSignal,
index = 0##
)
##Check if method EDE is applicable
if(is.na(elbowPoint[2,3])){
print("method EDE not applicable")
}
##Loading again data of genes without exluding those without signal (peak length 0)
genesWithSignal<-developForPlot[order(developForPlot$longitudPicos, decreasing = TRUE),]
genesWithSignal<-genesWithSignal$longitudPicos
nroObservacion_limiteSuperior_RegionKneePoint<-elbowPoint[1,1] ##Pq va en decreasing
nroObservacion_limiteInferior_RegionKneePoint<-elbowPoint[1,2] ##Pq va en decreasing
kneePoint_ejeX<-elbowPoint[1,3]
elbowPoint<-elbowPoint[1,1]##ESE
genesWithSignal[elbowPoint]
targetLongitudPico<-genesWithSignal[elbowPoint]
plot(x=1:length(genesWithSignal), y=genesWithSignal, type = "l", lwd=3, main = "H3K27me3 peak size associated to TSS \n in NCCs", xlab = "TSS", ylab="H3K27me3 peak size")
abline(h=c(targetLongitudPico),col="red", lwd=2, lty=2)
abline(v=nroObservacion_limiteSuperior_RegionKneePoint,col="red", lwd=2, lty=2)
abline(v=kneePoint_ejeX, col="blue", lwd=2, lty=2)
abline(v=nroObservacion_limiteInferior_RegionKneePoint, col="green", lwd=2, lty=2)
text(x= 20000, y=16000, paste0(targetLongitudPico, " bp"), col="red")
thresh<-targetLongitudPico
#####################################################################
##### seleccion genes (TSS) de desarrollo, aquellos cuyo overalapped H3K27me3 peak > thresh
#####################################################################
genesDesarrollo_allInfo<-developForPlot[developForPlot$longitudPicos>=thresh,]
selectedDevelopGenes<-sort(unique(as.character(genesDesarrollo_allInfo$gene)))
########################################################################
##### no nos interesan ni los LINC ni los LOC asi que vamos a quitarlos
########################################################################
AllGenes<-as.character(unique(developForPlot$gene))#27090
LINCs<-AllGenes[grep("^LINC.*", AllGenes)]
LOCs<-AllGenes[grep("^LOC[0-9].*", AllGenes)]
NotRelevant<-c(LINCs,LOCs)#LINCs and LOCs
##########################################################################
###### seleccion de los TSS de interes
##########################################################################
selectedDevelopGenes<-selectedDevelopGenes[!(selectedDevelopGenes %in% NotRelevant)]
print(thresh)
print(length(selectedDevelopGenes))
####################
## Saving results
####################
hs_pi2_polyCombGenes<-selectedDevelopGenes
save(hs_pi2_polyCombGenes, file = "~/Dropbox/Cantabria/PhD_Project/Resultados/genesDesarrollo/Robjects/hs_pi2_polyCombGenes.RData")
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/Revision_NAR/Manuscrito_New_Version/SupplementaryMaterial/SupplementaryFigures/Supplementary_Figure_1/NCCs.tiff", units="in",
width=6, height=3.8, res=300)
plot(x=1:length(genesWithSignal), y=genesWithSignal, type = "l", lwd=3, main = "H3K27me3 peak size associated to TSS \n in NCCs", xlab = "TSS", ylab="H3K27me3 peak size")
abline(h=c(targetLongitudPico),col="red", lwd=2, lty=2)
abline(v=nroObservacion_limiteSuperior_RegionKneePoint,col="red", lwd=2, lty=2)
abline(v=kneePoint_ejeX, col="blue", lwd=2, lty=2)
abline(v=nroObservacion_limiteInferior_RegionKneePoint, col="green", lwd=2, lty=2)
text(x= 20000, y=16000, paste0(targetLongitudPico, " bp"), col="red")
dev.off()
##############################################################################
##Master Regulators, those above the inflection point of the H3K27me3 curve
##############################################################################
###### filtering OverlapResults
## si los transcritos comparten TSS nos quedaremos con los 2 como un único
## pero si no lo comparten los trataremos por separado
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/genesDesarrollo/cardiomiocitos/heart_findingDevelopGenes.RData")
#vamos a trabajar con cada TSS por separado
#de forma que si los dos tienen un pico de H3K27me3, trabajaremos con los 2
# y si solo hay uno, nos quedaremos con ese solo
#no obstante si que nos quedaremos con una única fila, si los dos transcritos presentan el mismo TSS y estan mapeados con el mismo pico
dim(developmentMatrix)
developmentMatrix<-unique(developmentMatrix) # de 34513 a 34513 (expected)
dim(developmentMatrix)
developmentMatrix<-as.data.frame(developmentMatrix)
#### anyadir columna lengths
#las pos picos estan como factores, las pasamos a numerico
developmentMatrix$peakStart<-as.numeric(as.character(developmentMatrix$peakStart))
developmentMatrix$peakEnd<-as.numeric(as.character(developmentMatrix$peakEnd))
developmentMatrix$longitudPicos<-developmentMatrix$peakEnd - developmentMatrix$peakStart
min(developmentMatrix$longitudPicos) #0 as expected
developForPlot<-developmentMatrix
rm(developmentMatrix)
developForPlot<-developForPlot[order(developForPlot$longitudPicos,decreasing = F),]
###################################
## Computing line inflexion point
###################################
library(inflection)
#########################
##con el metodo ESE
##Ahora si quitamos todos los que tienen 0 bases de H3K27me3
##Reordenamos de mayor a menor para tenerlo como un scree plot
genesWithSignal<-developForPlot[order(developForPlot$longitudPicos, decreasing = TRUE),]
#To compute inflection point excluding the 0 values
genesWithSignal<-subset(genesWithSignal, longitudPicos>0)$longitudPicos
##Tal y como indican en el paper para el scree plot, que es el mismo concepto
elbowPoint<-findiplist(x = 1:length(genesWithSignal), y = genesWithSignal,
index = 0##
)
##Check if method EDE is applicable
if(is.na(elbowPoint[2,3])){
print("method EDE not applicable")
}
##Loading again data of genes without exluding those without signal (peak length 0)
genesWithSignal<-developForPlot[order(developForPlot$longitudPicos, decreasing = TRUE),]
genesWithSignal<-genesWithSignal$longitudPicos
nroObservacion_limiteSuperior_RegionKneePoint<-elbowPoint[1,1] ##Pq va en decreasing
nroObservacion_limiteInferior_RegionKneePoint<-elbowPoint[1,2] ##Pq va en decreasing
kneePoint_ejeX<-elbowPoint[1,3]
elbowPoint<-elbowPoint[1,1]##ESE
genesWithSignal[elbowPoint]
targetLongitudPico<-genesWithSignal[elbowPoint]
plot(x=1:length(genesWithSignal), y=genesWithSignal, type = "l", lwd=3, main = "H3K27me3 peak size associated to TSS \n in Cardiomyocites", xlab = "TSS", ylab="H3K27me3 peak size")
abline(h=c(targetLongitudPico),col="red", lwd=2, lty=2)
abline(v=nroObservacion_limiteSuperior_RegionKneePoint,col="red", lwd=2, lty=2)
abline(v=kneePoint_ejeX, col="blue", lwd=2, lty=2)
abline(v=nroObservacion_limiteInferior_RegionKneePoint, col="green", lwd=2, lty=2)
text(x= 20000, y=13000, paste0(targetLongitudPico, " bp"), col="red")
thresh<-targetLongitudPico
#####################################################################
##### seleccion genes (TSS) de desarrollo, aquellos cuyo overalapped H3K27me3 peak > thresh
#####################################################################
genesDesarrollo_allInfo<-developForPlot[developForPlot$longitudPicos>=thresh,]
selectedDevelopGenes<-sort(unique(as.character(genesDesarrollo_allInfo$gene)))
########################################################################
##### no nos interesan ni los LINC ni los LOC asi que vamos a quitarlos
########################################################################
AllGenes<-as.character(unique(developForPlot$gene))#27090
LINCs<-AllGenes[grep("^LINC.*", AllGenes)]
LOCs<-AllGenes[grep("^LOC[0-9].*", AllGenes)]
NotRelevant<-c(LINCs,LOCs)#LINCs and LOCs
##########################################################################
###### seleccion de los TSS de interes
##########################################################################
selectedDevelopGenes<-selectedDevelopGenes[!(selectedDevelopGenes %in% NotRelevant)]
print(thresh)
print(length(selectedDevelopGenes))
####################
## Saving results
####################
hs_cardiomiocytes_polyCombGenes<-selectedDevelopGenes
save(hs_cardiomiocytes_polyCombGenes, file = "~/Dropbox/Cantabria/PhD_Project/Resultados/genesDesarrollo/Robjects/hs_cardiomiocytes_polyCombGenes.RData")
tiff("/home/victor/Documentos/phD/ArticlesWritting/Postre_manuscript/Revision_NAR/Manuscrito_New_Version/SupplementaryMaterial/SupplementaryFigures/Supplementary_Figure_1/Cardiomyocytes.tiff", units="in",
width=6, height=3.8, res=300)
plot(x=1:length(genesWithSignal), y=genesWithSignal, type = "l", lwd=3, main = "H3K27me3 peak size associated to TSS \n in Cardiomyocites", xlab = "TSS", ylab="H3K27me3 peak size")
abline(h=c(targetLongitudPico),col="red", lwd=2, lty=2)
abline(v=nroObservacion_limiteSuperior_RegionKneePoint,col="red", lwd=2, lty=2)
abline(v=kneePoint_ejeX, col="blue", lwd=2, lty=2)
abline(v=nroObservacion_limiteInferior_RegionKneePoint, col="green", lwd=2, lty=2)
text(x= 20000, y=13000, paste0(targetLongitudPico, " bp"), col="red")
dev.off()
runApp('Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app')
runApp('Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app')
shiny::runApp('Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app')
runApp('Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app')
####################################################################
## Script for HTML generation for Web with Patients Cohort Study
####################################################################
##Use maybe the Standard info only
##Loading Standard Mode PARSED results
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/StandardMode_ParsedResults_MultiplePatientAnalyses.RData")
########################################
##HTML generation with cohort results
########################################
###Setwd in the folder where all the app info is hosted
setwd("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/")
##Required functions
source("functions/multiple_SV_Functions/multipleStats_ExplorePreviousPat_htmlGeneration.R")
##AllPatientsInfo table, required for the Patients Info section
load("~/Dropbox/Cantabria/PhD_Project/DatosPHD/fichasPacientes/AllPatientsInfo.RData")
##Phenotypes to be considered
consideredPheno<-c("head_neck",
"cardiovascular",
"limbs",
"neurodevelopmental")##As more phenos considered they will appear here
ExplorePreviousPatients_html<-multipleStats_htmlGeneration(cohort_results = cohort_results_standard,
consideredPheno = consideredPheno,
ids_append="PreviousPat",##to avoid conflicts with tables generated in multiples submission option
AllPatientsInfo=AllPatientsInfo,
explPreviousPatSection = TRUE)
###########################################################################################
##This is the html that is going to be loaded on the Explore Previous Patients Section
##Wrapp in html tags to avoid issues AND save html
###########################################################################################
ExplorePreviousPatients_html<-paste("<html><body>",
ExplorePreviousPatients_html,
"</body></html>",
sep="")
fileConn<-file("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/html_scripts/ExplorePreviousPatients.html")
writeLines(ExplorePreviousPatients_html, fileConn)
close(fileConn)
####################################################################
## Script for HTML generation for Web with Patients Cohort Study
####################################################################
##Use maybe the Standard info only
##Loading Standard Mode PARSED results
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/StandardMode_ParsedResults_MultiplePatientAnalyses.RData")
########################################
##HTML generation with cohort results
########################################
###Setwd in the folder where all the app info is hosted
setwd("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/")
##Required functions
source("functions/multiple_SV_Functions/multipleStats_ExplorePreviousPat_htmlGeneration.R")
##AllPatientsInfo table, required for the Patients Info section
load("~/Dropbox/Cantabria/PhD_Project/DatosPHD/fichasPacientes/AllPatientsInfo.RData")
##Phenotypes to be considered
consideredPheno<-c("head_neck",
"cardiovascular",
"limbs",
"neurodevelopmental")##As more phenos considered they will appear here
ExplorePreviousPatients_html<-multipleStats_htmlGeneration(cohort_results = cohort_results_standard,
consideredPheno = consideredPheno,
ids_append="PreviousPat",##to avoid conflicts with tables generated in multiples submission option
AllPatientsInfo=AllPatientsInfo,
explPreviousPatSection = TRUE)
###########################################################################################
##This is the html that is going to be loaded on the Explore Previous Patients Section
##Wrapp in html tags to avoid issues AND save html
###########################################################################################
ExplorePreviousPatients_html<-paste("<html><body>",
ExplorePreviousPatients_html,
"</body></html>",
sep="")
fileConn<-file("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/html_scripts/ExplorePreviousPatients.html")
writeLines(ExplorePreviousPatients_html, fileConn)
close(fileConn)
####################################################################
## Script for HTML generation for Web with Patients Cohort Study
####################################################################
##Use maybe the Standard info only
##Loading Standard Mode PARSED results
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/StandardMode_ParsedResults_MultiplePatientAnalyses.RData")
########################################
##HTML generation with cohort results
########################################
###Setwd in the folder where all the app info is hosted
setwd("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/")
##Required functions
source("functions/multiple_SV_Functions/multipleStats_ExplorePreviousPat_htmlGeneration.R")
##AllPatientsInfo table, required for the Patients Info section
load("~/Dropbox/Cantabria/PhD_Project/DatosPHD/fichasPacientes/AllPatientsInfo.RData")
##Phenotypes to be considered
consideredPheno<-c("head_neck",
"cardiovascular",
"limbs",
"neurodevelopmental")##As more phenos considered they will appear here
ExplorePreviousPatients_html<-multipleStats_htmlGeneration(cohort_results = cohort_results_standard,
consideredPheno = consideredPheno,
ids_append="PreviousPat",##to avoid conflicts with tables generated in multiples submission option
AllPatientsInfo=AllPatientsInfo,
explPreviousPatSection = TRUE)
###########################################################################################
##This is the html that is going to be loaded on the Explore Previous Patients Section
##Wrapp in html tags to avoid issues AND save html
###########################################################################################
ExplorePreviousPatients_html<-paste("<html><body>",
ExplorePreviousPatients_html,
"</body></html>",
sep="")
fileConn<-file("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/html_scripts/ExplorePreviousPatients.html")
writeLines(ExplorePreviousPatients_html, fileConn)
close(fileConn)
####################################################################
## Script for HTML generation for Web with Patients Cohort Study
####################################################################
##Use maybe the Standard info only
##Loading Standard Mode PARSED results
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/StandardMode_ParsedResults_MultiplePatientAnalyses.RData")
########################################
##HTML generation with cohort results
########################################
###Setwd in the folder where all the app info is hosted
setwd("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/")
##Required functions
source("functions/multiple_SV_Functions/multipleStats_ExplorePreviousPat_htmlGeneration.R")
##AllPatientsInfo table, required for the Patients Info section
load("~/Dropbox/Cantabria/PhD_Project/DatosPHD/fichasPacientes/AllPatientsInfo.RData")
##Phenotypes to be considered
consideredPheno<-c("head_neck",
"cardiovascular",
"limbs",
"neurodevelopmental")##As more phenos considered they will appear here
ExplorePreviousPatients_html<-multipleStats_htmlGeneration(cohort_results = cohort_results_standard,
consideredPheno = consideredPheno,
ids_append="PreviousPat",##to avoid conflicts with tables generated in multiples submission option
AllPatientsInfo=AllPatientsInfo,
explPreviousPatSection = TRUE)
###########################################################################################
##This is the html that is going to be loaded on the Explore Previous Patients Section
##Wrapp in html tags to avoid issues AND save html
###########################################################################################
ExplorePreviousPatients_html<-paste("<html><body>",
ExplorePreviousPatients_html,
"</body></html>",
sep="")
fileConn<-file("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/html_scripts/ExplorePreviousPatients.html")
writeLines(ExplorePreviousPatients_html, fileConn)
close(fileConn)
####################################################################
## Script for HTML generation for Web with Patients Cohort Study
####################################################################
##Use maybe the Standard info only
##Loading Standard Mode PARSED results
load(file = "~/Dropbox/Cantabria/PhD_Project/Resultados/softwareObjects/multiplePatientAnalysis/StandardMode_ParsedResults_MultiplePatientAnalyses.RData")
########################################
##HTML generation with cohort results
########################################
###Setwd in the folder where all the app info is hosted
setwd("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/")
##Required functions
source("functions/multiple_SV_Functions/multipleStats_ExplorePreviousPat_htmlGeneration.R")
##AllPatientsInfo table, required for the Patients Info section
load("~/Dropbox/Cantabria/PhD_Project/DatosPHD/fichasPacientes/AllPatientsInfo.RData")
##Phenotypes to be considered
consideredPheno<-c("head_neck",
"cardiovascular",
"limbs",
"neurodevelopmental")##As more phenos considered they will appear here
ExplorePreviousPatients_html<-multipleStats_htmlGeneration(cohort_results = cohort_results_standard,
consideredPheno = consideredPheno,
ids_append="PreviousPat",##to avoid conflicts with tables generated in multiples submission option
AllPatientsInfo=AllPatientsInfo,
explPreviousPatSection = TRUE)
###########################################################################################
##This is the html that is going to be loaded on the Explore Previous Patients Section
##Wrapp in html tags to avoid issues AND save html
###########################################################################################
ExplorePreviousPatients_html<-paste("<html><body>",
ExplorePreviousPatients_html,
"</body></html>",
sep="")
fileConn<-file("~/Dropbox/Cantabria/PhD_Project/ScriptsPhd/ScriptsParaUsoLocal/Postre/Postre_app/html_scripts/ExplorePreviousPatients.html")
writeLines(ExplorePreviousPatients_html, fileConn)
close(fileConn)
